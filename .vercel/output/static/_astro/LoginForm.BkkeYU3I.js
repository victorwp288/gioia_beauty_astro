import{j as e}from"./jsx-runtime.B4ELNKBR.js";import{r as o}from"./index.B80Lgev0.js";import{s as n}from"./supabaseClient.TEOPL8hC.js";import"./preload-helper.CLcXU_4U.js";function w(){const[l,m]=o.useState(""),[i,g]=o.useState(""),[d,a]=o.useState(null),[c,u]=o.useState(!1);o.useEffect(()=>{(async()=>{const{data:{session:r}}=await n.auth.getSession();r&&(console.log("User already logged in, redirecting..."),window.location.href="/admin")})()},[]),o.useEffect(()=>{const{data:{subscription:s}}=n.auth.onAuthStateChange((r,t)=>{console.log("Auth state changed:",r,t),t&&(window.location.href="/admin")});return()=>s.unsubscribe()},[]);const h=async s=>{s.preventDefault(),console.log("Login attempt started..."),a(null),u(!0);try{const{data:r,error:t}=await n.auth.signInWithPassword({email:l,password:i});if(t){console.error("Login error:",t),a(t.message);return}r?.session?(console.log("Login successful, session established"),setTimeout(()=>{window.location.replace("/admin")},500)):a("No session created after login")}catch(r){console.error("Unexpected error:",r),a("An unexpected error occurred")}finally{u(!1)}};return e.jsxs("form",{onSubmit:h,className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-center",children:"Login"}),d&&e.jsx("div",{className:"p-2 text-red-600 bg-red-100 border border-red-200 rounded",children:d}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium",children:"Email"}),e.jsx("input",{type:"email",id:"email",className:"w-full p-2 mt-1 border border-gray-300 rounded",value:l,onChange:s=>m(s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium",children:"Password"}),e.jsx("input",{type:"password",id:"password",className:"w-full p-2 mt-1 border border-gray-300 rounded",value:i,onChange:s=>g(s.target.value),required:!0})]}),e.jsx("button",{type:"submit",className:"w-full px-4 py-2 font-bold text-white bg-blue-600 rounded hover:bg-blue-700",disabled:c,children:c?"Logging in...":"Login"})]})}export{w as default};
